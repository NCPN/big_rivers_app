Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    Modal = NotDefault
    RecordSelectors = NotDefault
    MaxButton = NotDefault
    MinButton = NotDefault
    ControlBox = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ScrollBars =0
    ViewsAllowed =1
    BorderStyle =0
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =8884
    DatasheetFontHeight =11
    ItemSuffix =4
    Left =3360
    Top =5295
    Right =15975
    Bottom =13110
    DatasheetGridlinesColor =14806254
    RecSrcDt = Begin
        0x6ab456d96fb4e440
    End
    Caption ="MsgOverlay"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnClick ="[Event Procedure]"
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin Section
            Height =1020
            BackColor =-2147483607
            Name ="Detail"
            OnClick ="[Event Procedure]"
            Begin
                Begin CommandButton
                    Transparent = NotDefault
                    OverlapFlags =93
                    Left =180
                    Width =8460
                    Height =1020
                    ForeColor =4210752
                    Name ="btnEnter"
                    OnClick ="[Event Procedure]"
                    PictureData = Begin
                        0x2800000010000000100000000100040000000000800000000000000000000000 ,
                        0x0000000000000000000000000000800000800000008080008000000080008000 ,
                        0x8080000080808000c0c0c0000000ff00c0c0c00000ffff00ff000000c0c0c000 ,
                        0xffff0000ffffff00dddddddddddddddddddddddddddddddddddddddddddddddd ,
                        0xdddddddddddddddddddddddddddddddddddd00dddd00ddddddddd00dd00ddddd ,
                        0xdddddd0000ddddddddddddd00ddddddddddddd0000ddddddddddd00dd00ddddd ,
                        0xdddd00dddd00dddddddddddddddddddddddddddddddddddddddddddddddddddd ,
                        0xdddddddddddddddd000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OnKeyDown ="[Event Procedure]"
                    ObjectPalette = Begin
                        0x000301000000000000000000
                    End
                    ControlTipText ="Type Enter to dismiss"
                    GridlineColor =10921638
                    BackStyle =0

                    LayoutCachedLeft =180
                    LayoutCachedWidth =8640
                    LayoutCachedHeight =1020
                    UseTheme =0
                    Gradient =0
                    BackColor =14136213
                    OldBorderStyle =0
                    BorderColor =14136213
                    HoverColor =-2
                    HoverThemeColorIndex =-1
                    PressedColor =-2
                    PressedThemeColorIndex =-1
                    HoverForeColor =4210752
                    PressedForeColor =4210752
                    WebImagePaddingLeft =2
                    WebImagePaddingTop =2
                    WebImagePaddingRight =1
                    WebImagePaddingBottom =1
                    Overlaps =1
                End
                Begin Label
                    OverlapFlags =223
                    TextAlign =2
                    Left =2730
                    Top =180
                    Width =720
                    Height =360
                    FontSize =12
                    FontWeight =600
                    BorderColor =8355711
                    ForeColor =2366701
                    Name ="lblRecordNumber"
                    Caption ="1"
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638
                    LayoutCachedLeft =2730
                    LayoutCachedTop =180
                    LayoutCachedWidth =3450
                    LayoutCachedHeight =540
                    ForeThemeColorIndex =-1
                    ForeTint =100.0
                End
                Begin Label
                    OverlapFlags =215
                    TextAlign =2
                    Left =360
                    Top =180
                    Width =8085
                    Height =600
                    FontSize =12
                    BorderColor =8355711
                    Name ="lblMessage"
                    Caption ="ID #           record deleted from table X."
                    OnClick ="[Event Procedure]"
                    GridlineColor =10921638
                    LayoutCachedLeft =360
                    LayoutCachedTop =180
                    LayoutCachedWidth =8445
                    LayoutCachedHeight =780
                    ForeTint =100.0
                End
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' =================================
' MODULE:       MsgOverlay
' Level:        Form module
' Version:      1.02
' Description:  data functions & procedures specific to overlay message
'
' Source/date:  Bonnie Campbell, 2/2/2016
' Adapted:      -
' Revisions:    BLC - 2/3/2016  - 1.00 - initial version
'               BLC - 4/13/2016 - 1.01 - added btnEnter_Click, btnEnter_KeyDown events for handling
'                                        closing transect overlay on Enter
'               BLC - 6/1/2016  - 1.02 - adapted for messages vs. transect # overlay for Big Rivers
' =================================

' ---------------------------------
' SUB:          Form_Load
' Description:  Handles form loading actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, February 3, 2016 - for NCPN tools
' Revisions:
'   BLC, 2/3/2016  - initial version
'   BLC, 6/1/2016  - adjusted for Big Rivers application
'   BLC, 6/10/2016 - adjusted to accommodate other messages
' ---------------------------------
Private Sub Form_Load()
On Error GoTo Err_Handler

    Dim Transp As Long
    Dim Opac As Single 'opacity
    Dim ary() As String, ary2() As String
    Dim i As Integer
        
    'close when no message is passed
    If IsNull(Me.OpenArgs) Or Me.OpenArgs = 0 Then
        DoCmd.Close
        GoTo Exit_Handler
    End If
    
    'set background color default
    'to set color RGB, see http://www.rapidtables.com/web/color/RGB_Color.htm for Red/Green/Blue values
    Transp = lngRobinEgg 'RGB(153, 255, 51)
    
    If InStr(Me.OpenArgs, "|") Then
        ary = Split(Me.OpenArgs, "|")
        
        For i = 0 To UBound(ary)
            ary2 = Split(ary(i), PARAM_SEPARATOR)
            Select Case LCase(i)
                Case 0 'message info
                    Select Case LCase(ary2(0))
                        Case "contact", "event"
                            'set table
                            Me.lblMessage.Caption = "ID #" & Space(15) & "record deleted from " & ary2(0) & " table."
                            'set ID #
                            lblRecordNumber.Caption = ary2(1)
                            lblRecordNumber.Visible = True
                            
                        Case "tagline"
                            'set table
                            Me.lblMessage.Caption = "ID #" & Space(15) & "record deleted from " & ary2(0) & " table."
                            'set ID #
                            lblRecordNumber.Caption = ary2(1)
                            lblRecordNumber.Visible = True
                            
                        Case Else
                            lblMessage.Caption = ary2(1)
                            lblRecordNumber.Visible = False
                    End Select
                    
                Case 1 'overlay type
                    Select Case ary2(1)
                        Case "info"
                            Transp = lngRobinEgg 'RGB(153, 255, 51)
                            Opac = 0.9
                        Case "caution"
                            lblMessage.ForeColor = lngBlue
                            Transp = lngYellow
                            Opac = 0.9
                        Case "alert"
                            lblMessage.ForeColor = lngYellow
                            Transp = lngPink
                            Opac = 0.9
                        Case "done"
                            lblMessage.ForeColor = lngBlack
                            Transp = lngYelLime
                            Opac = 0.9
                    End Select
            End Select
        Next
     
    End If
    
    Me.Detail.BackColor = Transp
     
    Me.Painting = False
    'set background opacity
    SetFormOpacity Me, Opac, Transp
    Me.Painting = True

    'if message was open w/ pause setting, close it automatically after pause
    If Nz(TempVars("MsgOverlayPause"), 0) > 0 Then

            Pause TempVars("MsgOverlayPause")
            
'            Form_Click
            
    End If

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Open[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          Form_Click
' Description:  Handles form click actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, February 3, 2016 - for NCPN tools
' Revisions:
'   BLC, 2/3/2016  - initial version
' ---------------------------------
Private Sub Form_Click()
On Error GoTo Err_Handler

    DoCmd.Close
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Click[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          Detail_Click
' Description:  Handles form detail click actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, February 3, 2016 - for NCPN tools
' Revisions:
'   BLC, 2/3/2016  - initial version
' ---------------------------------
Private Sub Detail_Click()
On Error GoTo Err_Handler

    DoCmd.Close
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Detail_Click[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          lblTransect_Click
' Description:  Handles form transect label click actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, February 3, 2016 - for NCPN tools
' Revisions:
'   BLC, 2/3/2016  - initial version
' ---------------------------------
Private Sub lblTransect_Click()
On Error GoTo Err_Handler

    DoCmd.Close

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - lblTransect_Click[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          lblRecordNumber_Click
' Description:  Handles form transect number label click actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, June 1, 2016 - for NCPN tools
' Revisions:
'   BLC, 6/1/2016  - initial version
' ---------------------------------
Private Sub lblRecordNumber_Click()
On Error GoTo Err_Handler

    DoCmd.Close

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - lblRecordNumber_Click[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          btnEnter_KeyDown
' Description:  Handles form transect number key down actions
' Assumptions:  -
' Parameters:   KeyCode - code for key being pressed
'               Shift - if shift is also pressed
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, April 13, 2016 - for NCPN tools
' Revisions:
'   BLC, 4/13/2016  - initial version
' ---------------------------------
Private Sub btnEnter_KeyDown(KeyCode As Integer, Shift As Integer)
On Error GoTo Err_Handler

    'if user presses Enter (return) close the form
    If KeyCode = vbKeyReturn Then DoCmd.Close

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - btnEnter_KeyDown[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          btnEnter_Click
' Description:  Handles form enter button click actions
' Assumptions:  -
' Parameters:   -
' Returns:      N/A
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, April 13, 2016 - for NCPN tools
' Revisions:
'   BLC, 4/13/2016  - initial version
' ---------------------------------
Private Sub btnEnter_Click()
On Error GoTo Err_Handler

    'close the form
    DoCmd.Close

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - btnEnter_KeyDown[Form_MsgOverlay])"
    End Select
    Resume Exit_Handler
End Sub
