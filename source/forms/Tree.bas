Version =20
VersionRequired =20
Begin Form
    PopUp = NotDefault
    RecordSelectors = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    DefaultView =0
    ViewsAllowed =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =11400
    DatasheetFontHeight =11
    ItemSuffix =27
    Left =4035
    Top =3555
    Right =15690
    Bottom =12900
    DatasheetGridlinesColor =14806254
    RecSrcDt = Begin
        0x80331edabcc4e440
    End
    RecordSource ="Photo"
    Caption ="Photos"
    OnClose ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    AllowDatasheetView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    SplitFormSplitterBar =0
    SplitFormSplitterBar =0
    ShowPageMargins =0
    DisplayOnSharePointSite =1
    AllowLayoutView =0
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Line
            BorderLineStyle =0
            BorderThemeColorIndex =0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Image
            BackStyle =0
            OldBorderStyle =0
            BorderLineStyle =0
            SizeMode =3
            PictureAlignment =2
            BorderColor =16777215
            GridlineColor =16777215
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CommandButton
            FontSize =11
            FontWeight =400
            FontName ="Calibri"
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            UseTheme =1
            Shape =1
            Gradient =12
            BackThemeColorIndex =4
            BackTint =60.0
            BorderLineStyle =0
            BorderColor =16777215
            BorderThemeColorIndex =4
            BorderTint =60.0
            ThemeFontIndex =1
            HoverThemeColorIndex =4
            HoverTint =40.0
            PressedThemeColorIndex =4
            PressedShade =75.0
            HoverForeThemeColorIndex =0
            HoverForeTint =75.0
            PressedForeThemeColorIndex =0
            PressedForeTint =75.0
        End
        Begin CheckBox
            BorderLineStyle =0
            LabelX =230
            LabelY =-30
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            SpecialEffect =3
            BorderLineStyle =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ComboBox
            AddColon = NotDefault
            BorderLineStyle =0
            LabelX =-1800
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Subform
            BorderLineStyle =0
            BorderThemeColorIndex =1
            GridlineThemeColorIndex =1
            GridlineShade =65.0
            BorderShade =65.0
            ShowPageHeaderAndPageFooter =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =2
            ForeShade =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin CustomControl
            OldBorderStyle =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin FormHeader
            CanGrow = NotDefault
            Height =9360
            Name ="FormHeader"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin Label
                    OverlapFlags =85
                    Left =60
                    Top =60
                    Width =1512
                    Height =372
                    FontSize =14
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblPark"
                    Caption ="BLCA"
                    GridlineColor =10921638
                    LayoutCachedLeft =60
                    LayoutCachedTop =60
                    LayoutCachedWidth =1572
                    LayoutCachedHeight =432
                End
                Begin CustomControl
                    Enabled = NotDefault
                    SizeMode =1
                    OldBorderStyle =0
                    OverlapFlags =93
                    Left =120
                    Top =1800
                    Width =4140
                    Height =7440
                    AutoActivate =1
                    BorderColor =10921638
                    Name ="tvwTree"
                    OleData = Begin
                        0x00300000d0cf11e0a1b11ae1000000000000000000000000000000003e000300 ,
                        0xfeff090006000000000000000000000001000000000000000000000000100000 ,
                        0x0600000001000000feffffff0000000001000000ffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf02836280000000000000000000000002009ffb756d2d10107000000800e0000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000002000000f20d0000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fefffffffdfffffffffffffffffffffffffffffffffffffffeffffff ,
                        0x10000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff110000001200000013000000140000001500000016000000feffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff52006f006f007400200045006e007400720079000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000016000500ffffffffffffffff01000000b69041c78985d111b16a00c0 ,
                        0xf0283628000000000000000000000000e0d9bc3bc1c8d0010500000080100000 ,
                        0x0000000003004f006c0065004f0062006a006500630074004400610074006100 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x000000001e000201ffffffff02000000ffffffff000000000000000000000000 ,
                        0x00000000000000000000000000000000000000000000000002000000d20f0000 ,
                        0x0000000003004100630063006500730073004f0062006a005300690074006500 ,
                        0x4400610074006100000000000000000000000000000000000000000000000000 ,
                        0x0000000026000200ffffffffffffffffffffffff000000000000000000000000 ,
                        0x000000000000000000000000000000000000000000000000000000005c000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000ffffffffffffffffffffffff000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000fffffffffffffffffefffffffdfffffffeffffff08000000ffffffff ,
                        0xffffffff090000000a0000000b0000000c0000000d0000000e0000000f000000 ,
                        0xfeffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff01000000feffffff0300000004000000050000000600000007000000 ,
                        0x08000000090000000a0000000b0000000c0000000d0000000e0000000f000000 ,
                        0x1000000011000000120000001300000014000000150000001600000017000000 ,
                        0x18000000190000001a0000001b0000001c0000001d0000001e0000001f000000 ,
                        0x2000000021000000220000002300000024000000250000002600000027000000 ,
                        0x28000000290000002a0000002b0000002c0000002d0000002e0000002f000000 ,
                        0x3000000031000000320000003300000034000000350000003600000037000000 ,
                        0x38000000390000003a0000003b0000003c0000003d0000003e0000003f000000 ,
                        0x4000000041000000feffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000871c0000 ,
                        0x43330000b13cc16a01000600220000009d000000e80300002a00000001000000 ,
                        0x01efcdab0000050030d1410006280000000000000500008030d1410001000000 ,
                        0x5c001fdeecbd0100050079d141000352e30b918fce119de300aa004bb8510100 ,
                        0x00002c01b03001000d43616c69627269204c69676874080000004e6f64736400 ,
                        0x000002000000120000000c000000436f626a6400000008000000080000000100 ,
                        0x0000000000000200000052000000080000004e6f6465640000002c0000000701 ,
                        0x0000000000000000000000000000000000000000000068f3410005000080ffff ,
                        0xff000000ff000000ff0014000000030000000000000000003100660063000000 ,
                        0x0000140000000300000000000000000061003100650000000000140000000300 ,
                        0x00000000000000005f0039002e00000000001200000052006500660065007200 ,
                        0x65006e006300650000000c000000436f626a6400000008000000080000000100 ,
                        0x0000000001000000feffffff0300000004000000050000000600000007000000 ,
                        0x08000000090000000a0000000b0000000c0000000d0000000e0000000f000000 ,
                        0x1000000011000000120000001300000014000000150000001600000017000000 ,
                        0x18000000190000001a0000001b0000001c0000001d0000001e0000001f000000 ,
                        0x2000000021000000220000002300000024000000250000002600000027000000 ,
                        0x28000000290000002a0000002b0000002c0000002d0000002e0000002f000000 ,
                        0x3000000031000000320000003300000034000000350000003600000037000000 ,
                        0x3800000039000000feffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff ,
                        0xffffffff5c000000000000000100000000000000000000000000000000000000 ,
                        0x2400000038000000000000000000000000000000000000000000000039333638 ,
                        0x323635452d383546452d313164312d384245332d303030304638373534444131 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x00000000b69041c78985d111b16a00c0f02836282143341208000000871c0000 ,
                        0x43330000b13cc16a01000600220000009d000000e80300002a00000001000000 ,
                        0x01efcdab0000050040d39500062800000000000005000080fcd2950001000000 ,
                        0x5c001fdeecbd0100050045d395000352e30b918fce119de300aa004bb8510100 ,
                        0x00002c01f82401000d43616c69627269204c69676874080000004e6f64736400 ,
                        0x0000020000000d0000000c000000436f626a6400000008000000080000000100 ,
                        0x0000010000000200000052000000460000000900000000000000080000000000 ,
                        0x0000080000006d2d431911000000220000001100000049007c0050007c005200 ,
                        0x650066006500720065006e00630065007c0052007c0052000000080000004e6f ,
                        0x6465640000002c00000007010000000000000000000000000000000000000000 ,
                        0x000068f3410005000080ffffff000000ff000000ff0014000000030000000000 ,
                        0x0000000000000000000000000000140000000300000000000000000000000000 ,
                        0x000000000000020000004f000000080000004e6f6465640000002c0000000701 ,
                        0x000000000000000000000000000000000000000000003300300005000080ffff ,
                        0xff000000ff000000ff0014000000030000000000000000006e0073002e000000 ,
                        0x0000140000000300000000000000000074006800650000000000140000000300 ,
                        0x000000000000000065007200000000000000100000004f007600650072007600 ,
                        0x6900650077000c000000436f626a640000000800000008000000010000000000 ,
                        0x00000200000046000000080000004e6f6465640000002c000000070100000000 ,
                        0x00000000000000000000000000000000000065005f0005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000310066006300000000001400 ,
                        0x0000030000000000000000006100310065000000000014000000030000000000 ,
                        0x000000005f0039002e00000000000e0000004600650061007400750072006500 ,
                        0x00000c000000436f626a64000000080000000800000001000000000000000200 ,
                        0x000054000000080000004e6f6465640000002c00000007010000000000000000 ,
                        0x00000000000000000000000000003300300005000080ffffff000000ff000000 ,
                        0xff00140000000300000000000000000031002900200000000000140000000300 ,
                        0x000000000000000000000c000940000000001400000003000000000000000000 ,
                        0x65007200000000000000100000005400720061006e0073006500630074000c00 ,
                        0x0000436f626a6400000008000000080000000100000000000000040000004f00 ,
                        0x5400080000004e6f6465640000002c0000001701000000000000000000000000 ,
                        0x000000000000000000000000000005000080ffffff000000ff000000ff001400 ,
                        0x0000030000000000000000000000030020000000000014000000030000000000 ,
                        0x0000000000000300690000000000140000000300000000000000000000000300 ,
                        0xea10000000000a0000004f00740068006500720000000c000000436f626a6400 ,
                        0x000008000000080000000000000000000000080000004e6f6465640000002c00 ,
                        0x0000070100000000000000000000000000000500000000000000330030000500 ,
                        0x0080ffffff000000ff000000ff00140000000300000000000000000000000000 ,
                        0xea10000000001400000003000000000000000000000000000b40000000001400 ,
                        0x000003000000000000000000650072000000000000000c00000041006e006900 ,
                        0x6d0061006c000c000000436f626a640000000800000008000000000000000000 ,
                        0x0000080000004e6f6465640000002c0000001701000000000000000000000000 ,
                        0x0000050000000000000068f3410005000080ffffff000000ff000000ff001400 ,
                        0x0000030000000000000000003100660063000000000014000000030000000000 ,
                        0x000000006100310065000000000014000000030000000000000000005f003900 ,
                        0x2e00000000000a00000050006c0061006e00740000000c000000436f626a6400 ,
                        0x000008000000080000000000000000000000080000004e6f6465640000002c00 ,
                        0x000007010000000000000000000000000000050000000000000065005f000500 ,
                        0x0080ffffff000000ff000000ff00140000000300000000000000000031006600 ,
                        0x6300000000001400000003000000000000000000610031006500000000001400 ,
                        0x0000030000000000000000005f0039002e000000000010000000430075006c00 ,
                        0x74007500720061006c000c000000436f626a6400000008000000080000000000 ,
                        0x000000000000080000004e6f6465640000002c00000017010000000000000000 ,
                        0x000000000000050000000000000065005f0005000080ffffff000000ff000000 ,
                        0xff00140000000300000000000000000031006600630000000000140000000300 ,
                        0x0000000000000000610031006500000000001400000003000000000000000000 ,
                        0x5f0039002e000000000016000000440069007300740075007200620061006e00 ,
                        0x6300650000000c000000436f626a640000000800000008000000000000000000 ,
                        0x0000080000004e6f6465640000002c0000000701000000000000000000000000 ,
                        0x0000050000000000000065005f0005000080ffffff000000ff000000ff001400 ,
                        0x0000030000000000000000003100660063000000000014000000030000000000 ,
                        0x000000006100310065000000000014000000030000000000000000005f003900 ,
                        0x2e0000000000140000004600690065006c006400200057006f0072006b000c00 ,
                        0x0000436f626a6400000008000000080000000000000000000000080000004e6f ,
                        0x6465640000002c00000007010000000000000000000000000000050000000000 ,
                        0x000068f3410005000080ffffff000000ff000000ff0014000000030000000000 ,
                        0x000000006900730068000000000014000000030000000000000000002d006400 ,
                        0x690000000000140000000300000000000000000061006d006500000000000c00 ,
                        0x00005300630065006e00690063000c000000436f626a64000000080000000800 ,
                        0x00000000000000000000080000004e6f6465640000002c000000070100000000 ,
                        0x0000000000000000000005000000000000004200490005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000660074002000000000001400 ,
                        0x00000300000000000000000064005c0057000000000014000000030000000000 ,
                        0x00000000720076006500000000000e0000005700650061007400680065007200 ,
                        0x00000c000000436f626a64000000080000000800000000000000000000000800 ,
                        0x00004e6f6465640000002c000000070100000000000000000000000000000500 ,
                        0x0000000000000000000005000080ffffff000000ff000000ff00140000000300 ,
                        0x00000000000000005c0054006500000000001400000003000000000000000000 ,
                        0x7200790020000000000014000000030000000000000000006e00650074000000 ,
                        0x00000a0000004f00740068006500720000000c000000436f626a640000000800 ,
                        0x00000800000001000000000000006a00000043003a005c005500730065007200 ,
                        0x73005c005000750062006c00690063005c005000690063007400750072006500 ,
                        0x73005c00530061006d0070006c00650020005000690063007400750072006500 ,
                        0x73005c00500065006e006700750069006e0073002e006a007000670000000800 ,
                        0x00004e6f6465640000002c000000070000000000000000000000000000000900 ,
                        0x00000000000068f3410005000080ffffff000800008000000000140000000300 ,
                        0x0000000000000000310066006300000000001400000003000000000000000000 ,
                        0x6100310065000000000014000000030000000000000000005f0039002e000000 ,
                        0x000018000000500065006e006700750069006e0073002e006a00700067000c00 ,
                        0x0000436f626a64000000080000000800000001000000000000006c0000004300 ,
                        0x3a005c00550073006500720073005c005000750062006c00690063005c005000 ,
                        0x69006300740075007200650073005c00530061006d0070006c00650020005000 ,
                        0x69006300740075007200650073005c004a0065006c006c007900660069007300 ,
                        0x68002e006a0070006700080000004e6f6465640000002c000000070000000000 ,
                        0x0000000000000000000009000000000000003300300005000080ffffff000800 ,
                        0x0080000000001400000003000000000000000000610073006900000000001400 ,
                        0x00000300000000000000000065002e0061000000000014000000030000000000 ,
                        0x0000000061006d006500000000001a0000004a0065006c006c00790066006900 ,
                        0x730068002e006a007000670000000c000000436f626a64000000080000000800 ,
                        0x000001000000000000006400000043003a005c00550073006500720073005c00 ,
                        0x5000750062006c00690063005c00500069006300740075007200650073005c00 ,
                        0x530061006d0070006c0065002000500069006300740075007200650073005c00 ,
                        0x4b006f0061006c0061002e006a0070006700080000004e6f6465640000002c00 ,
                        0x000027000000000000000000000000000000090000000000000065005f000500 ,
                        0x0080ffffff000800008000000000140000000300000000000000000031006600 ,
                        0x6300000000001400000003000000000000000000610031006500000000001400 ,
                        0x0000030000000000000000005f0039002e0000000000120000004b006f006100 ,
                        0x6c0061002e006a007000670000000c000000436f626a64000000080000000800 ,
                        0x000001000000000000006e00000043003a005c00550073006500720073005c00 ,
                        0x5000750062006c00690063005c00500069006300740075007200650073005c00 ,
                        0x530061006d0070006c0065002000500069006300740075007200650073005c00 ,
                        0x4c00690067006800740068006f007500730065002e006a007000670000000800 ,
                        0x00004e6f6465640000002c000000070000000000000000000000000000000900 ,
                        0x00000000000068f3410005000080ffffff000800008000000000140000000300 ,
                        0x0000000000000000310066006300000000001400000003000000000000000000 ,
                        0x6100310065000000000014000000030000000000000000005f0039002e000000 ,
                        0x00001c0000004c00690067006800740068006f007500730065002e006a007000 ,
                        0x67000c000000436f626a64000000080000000800000001000000000000006e00 ,
                        0x000043003a005c00550073006500720073005c005000750062006c0069006300 ,
                        0x5c00500069006300740075007200650073005c00530061006d0070006c006500 ,
                        0x2000500069006300740075007200650073005c00480079006400720061006e00 ,
                        0x67006500610073002e006a00700067000000080000004e6f6465640000002c00 ,
                        0x000007000000000000000000000000000000070000000000000068f341000500 ,
                        0x0080ffffff00080000800000000014000000030000000000000000003d003000 ,
                        0x2d000000000014000000030000000000000000002d0044006500000000001400 ,
                        0x000003000000000000000000290020002b00000000001c000000480079006400 ,
                        0x720061006e0067006500610073002e006a007000670000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000001400000003000000000000000000000000000000000000001200 ,
                        0x00005200650066006500720065006e006300650000000c000000436f626a6400 ,
                        0x0000080000000800000001000000010000000200000056000000440000000900 ,
                        0x000000000000080000000000000008000000956feb1310000000200000001000 ,
                        0x000049007c0050007c004f0076006500720076006900650077007c0056007c00 ,
                        0x5600080000004e6f6465640000002c0000000701000000000000000000000000 ,
                        0x000000000000000000003300300005000080ffffff000000ff000000ff001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x0000000000000000000000000000140000000300000000000000000000000000 ,
                        0x000000000000100000004f0076006500720076006900650077000c000000436f ,
                        0x626a640000000800000008000000010000000100000002000000460000004200 ,
                        0x00000900000000000000080000000000000008000000cd6aeb130f0000001e00 ,
                        0x00000f00000049007c0050007c0046006500610074007500720065007c004600 ,
                        0x7c0046000000080000004e6f6465640000002c00000007010000000000000000 ,
                        0x000000000000000000000000000065005f0005000080ffffff000000ff000000 ,
                        0xff00140000000300000000000000000000000000000000000000140000000300 ,
                        0x0000000000000000000000000000000000001400000003000000000000000000 ,
                        0x000000000000000000000e000000460065006100740075007200650000000c00 ,
                        0x0000436f626a6400000008000000080000000100000001000000020000005400 ,
                        0x00004400000009000000000000000800000000000000080000001d3343191000 ,
                        0x0000200000001000000049007c0050007c005400720061006e00730065006300 ,
                        0x74007c0054007c005400080000004e6f6465640000002c000000070100000000 ,
                        0x00000000000000000000000000000000000068f3410005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000000000000000000000001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x0000000000000000000000000000100000005400720061006e00730065006300 ,
                        0x74000c000000436f626a64000000080000000800000001000000010000000200 ,
                        0x00004f0000003e0000000800000000000000080000000000000008000000e528 ,
                        0x1b190d0000001a0000000d00000049007c0050007c004f007400680065007200 ,
                        0x7c004f007c004f000000080000004e6f6465640000002c000000170100000000 ,
                        0x0000000000000000000000000000000000004200490005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000000000000000000000001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x00000000000000000000000000000a0000004f00740068006500720000000c00 ,
                        0x0000436f626a6400000008000000080000000100000001000000040000004f00 ,
                        0x4100440000000900000000000000080000000000000008000000453043191000 ,
                        0x0000200000001000000049007c0050007c0041006e0069006d0061006c007c00 ,
                        0x4f0041007c004f004100080000004e6f6465640000002c000000070100000000 ,
                        0x00000000000000000000050000000000000065005f0005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000000000000000000000001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x00000000000000000000000000000c00000041006e0069006d0061006c000c00 ,
                        0x0000436f626a6400000008000000080000000100000001000000040000004f00 ,
                        0x50004200000009000000000000000800000000000000080000004d6feb130f00 ,
                        0x00001e0000000f00000049007c0050007c0050006c0061006e0074007c004f00 ,
                        0x50007c004f0050000000080000004e6f6465640000002c000000070100000000 ,
                        0x00000000000000000000050000000000000068f3410005000080ffffff000000 ,
                        0xff000000ff001400000003000000000000000000000000000000000000001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x00000000000000000000000000000a00000050006c0061006e00740000000c00 ,
                        0x0000436f626a6400000008000000080000000100000001000000040000004f00 ,
                        0x43004800000009000000000000000800000000000000080000007d3043191200 ,
                        0x0000240000001200000049007c0050007c00430075006c007400750072006100 ,
                        0x6c007c004f0043007c004f004300080000004e6f6465640000002c0000000701 ,
                        0x0000000000000000000000000000050000000000000065005f0005000080ffff ,
                        0xff000000ff000000ff0014000000030000000000000000000000000000000000 ,
                        0x0000140000000300000000000000000000000000000000000000140000000300 ,
                        0x00000000000000000000000000000000000010000000430075006c0074007500 ,
                        0x720061006c000c000000436f626a640000000800000008000000010000000100 ,
                        0x0000040000004f0044004e0000000a0000000000000008000000000000000800 ,
                        0x0000b5304319150000002a0000001500000049007c0050007c00440069007300 ,
                        0x740075007200620061006e00630065007c004f0044007c004f00440000000800 ,
                        0x00004e6f6465640000002c000000070100000000000000000000000000000500 ,
                        0x00000000000068f3410005000080ffffff000000ff000000ff00140000000300 ,
                        0x0000000000000000000000000000000000001400000003000000000000000000 ,
                        0x0000000000000000000014000000030000000000000000000000000000000000 ,
                        0x000016000000440069007300740075007200620061006e006300650000000c00 ,
                        0x0000436f626a6400000008000000080000000100000001000000040000004f00 ,
                        0x46004c0000000a00000000000000080000000000000008000000ed3043191400 ,
                        0x0000280000001400000049007c0050007c004600690065006c00640020005700 ,
                        0x6f0072006b007c004f0046007c004f004600080000004e6f6465640000002c00 ,
                        0x0000070100000000000000000000000000000500000000000000330030000500 ,
                        0x0080ffffff000000ff000000ff00140000000300000000000000000000000000 ,
                        0x0000000000001400000003000000000000000000000000000000000000001400 ,
                        0x0000030000000000000000000000000000000000000014000000460069006500 ,
                        0x6c006400200057006f0072006b000c000000436f626a64000000080000000800 ,
                        0x00000100000001000000040000004f0053004400000009000000000000000800 ,
                        0x000000000000080000002d2f431910000000200000001000000049007c005000 ,
                        0x7c005300630065006e00690063007c004f0053007c004f005300080000004e6f ,
                        0x6465640000002c00000007010000000000000000000000000000050000000000 ,
                        0x000065005f0005000080ffffff000000ff000000ff0014000000030000000000 ,
                        0x0000000000000000000000000000140000000300000000000000000000000000 ,
                        0x0000000000001400000003000000000000000000000000000000000000000c00 ,
                        0x00005300630065006e00690063000c000000436f626a64000000080000000800 ,
                        0x00000100000001000000040000004f0057004600000009000000000000000800 ,
                        0x00000000000008000000a52d431911000000220000001100000049007c005000 ,
                        0x7c0057006500610074006800650072007c004f0057007c004f00570000000800 ,
                        0x00004e6f6465640000002c000000070100000000000000000000000000000500 ,
                        0x0000000000000000000005000080ffffff000000ff000000ff00140000000300 ,
                        0x0000000000000000000000000000000000001400000003000000000000000000 ,
                        0x0000000000000000000014000000030000000000000000000000000000000000 ,
                        0x00000e000000570065006100740068006500720000000c000000436f626a6400 ,
                        0x000008000000080000000100000001000000040000004f004f00420000000900 ,
                        0x0000000000000800000000000000080000005d3143190f0000001e0000000f00 ,
                        0x000049007c0050007c004f0074006800650072007c004f004f007c004f004f00 ,
                        0x0000080000004e6f6465640000002c0000002701000000000000000000000000 ,
                        0x000005000000000000003300300005000080ffffff000000ff000000ff001400 ,
                        0x0000030000000000000000000000000000000000000014000000030000000000 ,
                        0x0000000000000000000000000000140000000300000000000000000000000000 ,
                        0x0000000000000a0000004f007400680065007200000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000000000000000000000000000000000000000000000000000 ,
                        0x0000000000000000
                    End
                    OLEClass ="TreeCtrl"
                    Class ="MSComctlLib.TreeCtrl.2"
                    GridlineColor =10921638

                    LayoutCachedLeft =120
                    LayoutCachedTop =1800
                    LayoutCachedWidth =4260
                    LayoutCachedHeight =9240
                End
                Begin Image
                    Left =6180
                    Top =180
                    Width =3420
                    Height =2100
                    BorderColor =10921638
                    Name ="imgPhoto"
                    OnDblClick ="[Event Procedure]"
                    ControlTipText ="Double click to enlarge"
                    GridlineColor =10921638

                    LayoutCachedLeft =6180
                    LayoutCachedTop =180
                    LayoutCachedWidth =9600
                    LayoutCachedHeight =2280
                    TabIndex =2
                End
                Begin Subform
                    CanShrink = NotDefault
                    OverlapFlags =215
                    Left =4440
                    Top =2400
                    Width =6780
                    Height =6840
                    TabIndex =1
                    BorderColor =10921638
                    Name ="fsub"
                    SourceObject ="Form.PhotoOtherDetails"
                    GridlineColor =10921638

                    LayoutCachedLeft =4440
                    LayoutCachedTop =2400
                    LayoutCachedWidth =11220
                    LayoutCachedHeight =9240
                    Begin
                        Begin Label
                            Visible = NotDefault
                            OverlapFlags =93
                            Left =4440
                            Top =2160
                            Width =1320
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="lblSubform"
                            Caption ="Photo Details"
                            GridlineColor =10921638
                            LayoutCachedLeft =4440
                            LayoutCachedTop =2160
                            LayoutCachedWidth =5760
                            LayoutCachedHeight =2475
                        End
                    End
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =1020
                    Width =1185
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblPhotoType"
                    Caption ="Photo Type:"
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =1020
                    LayoutCachedWidth =1305
                    LayoutCachedHeight =1335
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =85
                    Left =1380
                    Top =1020
                    Width =2940
                    Height =317
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblPhotoTypeValue"
                    Caption ="Other"
                    GridlineColor =10921638
                    LayoutCachedLeft =1380
                    LayoutCachedTop =1020
                    LayoutCachedWidth =4320
                    LayoutCachedHeight =1337
                End
                Begin Label
                    OverlapFlags =85
                    Left =120
                    Top =1380
                    Width =1185
                    Height =315
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblFile"
                    Caption ="File:"
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =1380
                    LayoutCachedWidth =1305
                    LayoutCachedHeight =1695
                End
                Begin Label
                    FontItalic = NotDefault
                    OverlapFlags =85
                    Left =1380
                    Top =1380
                    Width =2940
                    Height =317
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblPhotoFilename"
                    Caption ="Other"
                    OnDblClick ="[Event Procedure]"
                    GridlineColor =10921638
                    LayoutCachedLeft =1380
                    LayoutCachedTop =1380
                    LayoutCachedWidth =4320
                    LayoutCachedHeight =1697
                End
                Begin Label
                    OverlapFlags =85
                    Left =1860
                    Top =60
                    Width =1512
                    Height =372
                    FontSize =14
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblSite"
                    GridlineColor =10921638
                    LayoutCachedLeft =1860
                    LayoutCachedTop =60
                    LayoutCachedWidth =3372
                    LayoutCachedHeight =432
                End
                Begin Label
                    OverlapFlags =85
                    Left =3660
                    Top =60
                    Width =1512
                    Height =372
                    FontSize =14
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblFeature"
                    GridlineColor =10921638
                    LayoutCachedLeft =3660
                    LayoutCachedTop =60
                    LayoutCachedWidth =5172
                    LayoutCachedHeight =432
                End
                Begin Label
                    Visible = NotDefault
                    FontItalic = NotDefault
                    OverlapFlags =85
                    Left =120
                    Top =480
                    Width =5940
                    Height =497
                    FontSize =9
                    FontWeight =500
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="lblError"
                    Caption ="Error"
                    GridlineColor =10921638
                    LayoutCachedLeft =120
                    LayoutCachedTop =480
                    LayoutCachedWidth =6060
                    LayoutCachedHeight =977
                End
                Begin Label
                    OverlapFlags =247
                    Left =1740
                    Top =3180
                    Width =75
                    Height =45
                    BorderColor =8355711
                    ForeColor =8355711
                    Name ="Label26"
                    GridlineColor =10921638
                    LayoutCachedLeft =1740
                    LayoutCachedTop =3180
                    LayoutCachedWidth =1815
                    LayoutCachedHeight =3225
                End
            End
        End
        Begin Section
            Height =0
            Name ="Detail"
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
        Begin FormFooter
            Height =0
            Name ="FormFooter"
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

' =================================
' MODULE:       Tree form
' Description:  Treeview functions & procedures
' Level:        Framework form
' Version:      1.05
'
' Source/date:  Bonnie Campbell, 7/10/2015
' Revisions:    BLC - 7/10/2015 - 1.00 - initial version
'               BLC - 6/13/2016 - 1.01 - adapted to big rivers
'               BLC - 6/24/2016 - 1.02 - replaced Exit_Function > Exit_Handler
'               BLC - 6/29/2016 - 1.03 - added header captions
'               BLC - 8/30/2016 - 1.04 - moved ParseStrings() to mod_Strings,
'                                        LoadTree(), AddChildren(), IsDuplicateKey(),
'                                        FindSpecificNode(), tvwNodeSelect() to mod_Tree
'               BLC - 9/1/2016  - 1.05 - add LoadTree() calls on form open to populate tree images
'                                        from usys_temp_photo & Photo tables
' =================================

'---------------------
' Simulated Inheritance
'---------------------

'---------------------
' Declarations
'---------------------

'---------------------
' Event Declarations
'---------------------

'---------------------
' Properties
'---------------------

'---------------------
' Methods
'---------------------

' ---------------------------------
' SUB:          Form_Load
' Description:  form loading actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:
'   Eldar Agalarov, October 14, 2013
'   http://stackoverflow.com/questions/19369132/declare-and-initialize-string-array-in-vba
'   miketr, June 6, 2002
'   http://vbcity.com/forums/t/3805.aspx
' Source/date:
' Adapted:      Bonnie Campbell, July 10, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/10/2015 - initial version
'   BLC - 6/29/2016 - added park,site,feature header captions
' ---------------------------------
Private Sub Form_Load()
On Error GoTo Err_Handler
    
    Dim aryPhotoTypes() As String, Code As String
    Dim PhotoType As Variant
    Dim nodeCurrent As Node, nodeRoot As Node, SelectedNode As Node
    
    'minimize Main
    ToggleForm "Main", -1
    
    'set park, site, feature info
    lblPark.Caption = Nz(TempVars("ParkCode"), "")
    lblSite.Caption = Nz(TempVars("SiteCode"), "")
    lblFeature.Caption = Nz(TempVars("Feature"), "")
    
    'set standard types (use split to retain as strings vs. variants)
    aryPhotoTypes = Split(PHOTO_TYPES_MAIN, ",")
    
    'add unclassified type
    ReDim Preserve aryPhotoTypes(UBound(aryPhotoTypes) + 1)
    aryPhotoTypes(UBound(aryPhotoTypes)) = "Unclassified"
    
    With tvwTree
    
        'clear tree
        .Nodes.Clear
        
        'add static nodes & format
        For Each PhotoType In aryPhotoTypes
            If PhotoType <> "Overview" Then
                Code = Left(CStr(PhotoType), 1)
            Else
                Code = "V"
            End If
            
            Set nodeCurrent = .Nodes.Add(, , Code, CStr(PhotoType))
            
            nodeCurrent.Tag = "I|P|" & CStr(PhotoType) & "|" & Code & "|" & Code
            nodeCurrent.Bold = True
            nodeCurrent.ForeColor = vbBlue
        
            If Code = "O" Then
                'add other nodes & format
                
                Dim chld As Variant
                For Each chld In Split(PHOTO_TYPES_OTHER, ",")
                    Dim nodeX As Node
                    
                    Code = "O" & Left(CStr(chld), 1)

                    Set nodeX = .Nodes.Add(nodeCurrent, tvwChild, Code, CStr(chld))
                    nodeX.ForeColor = vbBlue
                    nodeX.Bold = True
                    nodeX.Tag = "I|P|" & CStr(chld) & "|" & Code & "|" & Code
                Next
'                AddChildren tvwTree, nodeCurrent, ChildPhotoTypes
            End If
        Next
                
        'set phototype from tree
        Set SelectedNode = Me.tvwTree.Object.SelectedItem
'        If Not IsNothing(SelectedNode) Then
'            TempVars("phototype") = ParseString(SelectedNode.Tag, 4)
'        Else
'            TempVars("phototype") = ""
'        End If
    
    End With
    
    'expand "Other" node on open
    tvwTree_FindNode "O", "key", True
'    FindSpecificNode Me.tvwTree.Object, "OT"

    '---------------------
    ' Unclassified Node
    '---------------------
    'place unclassified @ top --> re-setting to current parent inserts the node at the top
    '                             of the tree with its children
    '                             w/o adding/deleting nodes & rebuilding the tree
    
  '  Set tvwTree.Nodes("Unclassified").Parent = Me.tvwTree.Nodes("Root")
    
    'highlight
    'tvwTree.Nodes("Unclassified").ForeColor = lngRed
       
    '---------------------
    ' Load Images
    '---------------------
    Dim datasource(0 To 1) As String
    Dim params() As Variant
    Dim i As Integer

    datasource(0) = "s_photo_data"
    datasource(1) = "s_usys_temp_photo_data"

    For i = 0 To UBound(datasource)
        LoadTree Me.Form, tvwTree.Object, datasource(i), params
    Next

    'set subform
    PopulateSubForm

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Load[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' Sub:          Form_Close
' Description:  form closing actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   -
' Source/date:  Bonnie Campbell, June 29, 2016 - for NCPN tools
' Adapted:      -
' Revisions:
'   BLC - 6/29/2016 - initial version
' ---------------------------------
Private Sub Form_Close()
On Error GoTo Err_Handler

    'restore Main
    ToggleForm "Main", 0
    
Exit_Handler:
    Exit Sub
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Close[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          tvwTree_BeforeLabelEdit
' Description:  prevent node text editing on click
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:
'   MSDN, no date noted
'   https://msdn.microsoft.com/en-us/library/aa443033(v=vs.60).aspx
' Source/date:
' Adapted:      Bonnie Campbell, July 27, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/27/2015 - initial version
' ---------------------------------
Private Sub tvwTree_BeforeLabelEdit(Cancel As Integer)
On Error GoTo Err_Handler
   
      Cancel = True   ' Cancel the operation

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tvwTree_BeforeLabelEdit[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          imgPhoto_DblClick
' Description:  enlarge photo on double click
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, July 27, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/27/2015 - initial version
' ---------------------------------
Private Sub imgPhoto_DblClick(Cancel As Integer)
On Error GoTo Err_Handler

    DoCmd.OpenForm "PhotoEnlarge", acNormal, , , , , TempVars("FullPhotoPath")

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - imgPhoto_DblClick[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          lblPhotoFilename_DblClick
' Description:  Launches and finds photo in explorer on double click
' Assumptions:  -
' Parameters:   Cancel (integer)
' Returns:      -
' Throws:       none
' References:
' Alex K., June 26, 2012
' http://stackoverflow.com/questions/11205719/how-to-open-a-folder-in-windows-explorer-from-vba
' GlenFromIowa, May 11, 2014
' http://stackoverflow.com/questions/23539852/vba-to-open-explorer-and-select-not-open-a-selected-file-name
' Source/date:  see references
' Adapted:      Bonnie Campbell, July 10, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/10/2015 - initial version
' ---------------------------------
Private Sub lblPhotoFilename_DblClick(Cancel As Integer)
On Error GoTo Err_Handler

    Dim strPath As String, strPhotoFullPath As String

    'open file location/directory

    'filepath
    'strPath = "C:\Users\Public\Pictures\Sample Pictures\"
    
    'TempVars("FullPhotoPath") = strPath & lblPhotoFilename.Caption
    'TempVars("FullPhotoPath") = strPath & "Chrysanthemum.jpg"
       
    Dim strFolder As String
'Foldername = "\\server\Instructions\"

    ' open & select file
    Shell "explorer /select,""" & TempVars("FullPhotoPath") & "", vbNormalFocus

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - lblPhotoFilename_DblClick[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

'================================
' Treeview Events
'================================

' ---------------------------------
' SUB:          tvwTree_MouseDown
' Description:  treeview node mouse down actions
' Assumptions:  -
' Parameters:   Node being clicked (node object)
' Returns:      -
' Throws:       none
' References:
'  asp1n, March 6, 2004
'  http://www.xtremevbtalk.com/showthread.php?t=133762
' Source/date:  Bonnie Campbell, July 10, 2015 - for NCPN tools
' Adapted:
' Revisions:
'   BLC - 7/27/2015 - initial version
' ---------------------------------
Private Sub tvwTree_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, _
                ByVal x As Long, ByVal y As Long)
'Private Sub tvwTree_MouseDownX(Button As Integer, Shift As Integer, _
'                                x As Single, y As Single)
On Error GoTo Err_Handler
    Dim Node As Node
    Dim blnNodeSelected As Boolean
        
    Set Node = tvwTree.HitTest(x, y)
    If Node Is Nothing Or Shift <> 2 Then
        blnNodeSelected = False
'        tvwNodeSelect
    ElseIf Shift = 2 Then
        blnNodeSelected = True
    End If
    
    If Not Node Is Nothing Then
        'show popup menu on right click of image nodes
        If Button = acRightButton And Not ImmovableNode(Node) Then CreatePopUpMenu Node
    End If
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tvwTree_MouseDown[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          tvwTree_NodeClick
' Description:  treeview node click actions
' Assumptions:  -
' Parameters:   Node being clicked (node object)
' Returns:      -
' Throws:       none
' References:
'  asp1n, March 6, 2004
'  http://www.xtremevbtalk.com/showthread.php?t=133762
' Source/date:  Bonnie Campbell, July 10, 2015 - for NCPN tools
' Adapted:
' Revisions:
'   BLC - 7/10/2015 - initial version
' ---------------------------------
'Private Sub tvwTree_NodeClick(ByVal Node As MSComctlLib.Node) 'Object)
Private Sub tvwTree_NodeClick(ByVal Node As Object)
On Error GoTo Err_Handler

    TempVars("phototype") = IIf(Len(Node.Tag) > 0, ParseString(Node.Tag, 4), "")
    
    'set headers based on node
    Me.lblPhotoFilename.Caption = Node
    If Not Node.Parent Is Nothing Then 'IsNothing(node.Parent) Then
        Me.lblPhotoTypeValue.Caption = Node.Parent
        'set phototype to key of parent
        'TempVars("phototype") = node.Parent
    Else
        Me.lblPhotoTypeValue.Caption = Node
    End If
    
    'set image based on node
    If FileExists(Node.key) Then
        Me.imgPhoto.Picture = Node.key
        TempVars("FullPhotoPath") = Node.key
        
    Else
        Me.imgPhoto.Picture = ""
        TempVars("FullPhotoPath") = ""
    End If
        
     'Me.fsub.Form.Requery
     PopulateSubForm
    
    'handle multi-select
'    Call tvwNodeSelect(Node, blnNodeSelected)
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tvwTree_NodeClick[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

'================================
' Treeview Drag & Drop Events
'================================

'====================================================================
'Use the OLEDragOver event of the TreeView control to select the
'node to drag, and to highlight the target nodes where the drop will
'occur when you release the mouse. This procedure sets the selected
'node to drag once. After that, if a node is already selected, the
'procedure assumes it was set during an earlier call in the dragging
'process and it does not reset it.  The second half of this procedure
'highlights the node you are dragging over.
'====================================================================

' ---------------------------------
' SUB:          tvwTree_OLEDragDrop
' Description:  treeview OLE drag/drop actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
'   https://support.microsoft.com/en-us/kb/209898
' Adapted:      Bonnie Campbell, July 10, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/10/2015 - initial version
' ---------------------------------
Private Sub tvwTree_OLEDragOver(Data As Object, Effect As Long, _
        Button As Integer, Shift As Integer, x As Single, y As Single, _
        State As Integer)

On Error GoTo Err_Handler

    Dim oTree As Treeview

    'Create a reference to the TreeView control.
    Set oTree = Me!tvwTree.Object

    'If no node is selected, select the first node you dragged over.
    If oTree.SelectedItem Is Nothing Then
        Set oTree.SelectedItem = oTree.HitTest(x, y)
    End If

    'Highlight the node being dragged over as a potential drop target.
    Set oTree.DropHighlight = oTree.HitTest(x, y)

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tvwTree_OLEDragOver[frm_Tree])"
    End Select
    Resume Exit_Handler
End Sub

'==================================================================
'The OLEDragDrop event moves the selected node on the TreeView
'control to its new location and changes the corresponding record in
'the Employees table. The procedure first checks that the TreeView
'has a selected node. If so, it continues to check if a drop target
'node is highlighted. If no node is highlighted, then the user has
'dragged the node off the tree and dropped it into a blank area, and
'the procedure adds a branch to the root of the tree. If a node is
'highlighted, the procedure modifies the Employee table's ReportTo
'field accordingly and sets the selected node's parent property
'to the node that has the drop highlight.
'==================================================================
' ---------------------------------
' SUB:          tvwTree_OLEDragDrop
' Description:  treeview drag/drop actions
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
'   https://support.microsoft.com/en-us/kb/209898
' Adapted:      Bonnie Campbell, July 10, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/10/2015 - initial version
' ---------------------------------
Private Sub tvwTree_OLEDragDrop(Data As Object, Effect As Long, _
        Button As Integer, Shift As Integer, x As Single, y As Single)
    On Error GoTo Err_Handler

    Dim oTree As Treeview
    Dim strKey As String, strText As String
    Dim nodeNew As Node, nodeDragged As Node
'    Dim db As Database
'    Dim rs As Recordset
'    Set db = CurrentDb
'     ' Open the photo table for editing
'    Set rs = db.OpenRecordset("Employees", dbOpenDynaset)

    'clear error msg
    lblError.Caption = ""

    'Create a reference to the TreeView control
    Set oTree = Me!tvwTree.Object
    
    'ensure the parent is a static node
    If Len(oTree.DropHighlight.key) > 2 Then oTree.DropHighlight = oTree.DropHighlight.Parent

    '----------------------------
    '   No Selected Node
    '----------------------------
    If oTree.SelectedItem Is Nothing Then
        'If nothing is selected for drag, do nothing
        
    '----------------------------
    '   Selected Node Present
    '----------------------------
    Else
        
        'Reference the selected node as the one being dragged.
        Set nodeDragged = oTree.SelectedItem
        
        '-------------------------------
        '  Node Dragged to Empty Space
        '-------------------------------
        ' update the db table & make it a root node
        If oTree.DropHighlight Is Nothing Then
                   
            'Save key & text to use when node re-added
            strKey = nodeDragged.key
            strText = nodeDragged.Text
                
             'selected node = immovable --> highlight selected item only
             If ImmovableNode(nodeDragged) Then Set oTree.SelectedItem = oTree.DropHighlight
                
             'selected node = movable --> add as root node
             If Not ImmovableNode(nodeDragged) Then
               
                'delete current node
                oTree.Nodes.Remove nodeDragged.index
        
                'add as a root node
                Set nodeNew = oTree.Nodes.Add(, , strKey, strText)
                nodeNew.Tag = "M|C|" & strKey & "|" & strText & "| "
                
                Me.lblPhotoTypeValue.Caption = ""
                
            End If
                'Add all the child nodes for this employee.
                'AddChildren nodNew, rs
                'If you are not dropping the node on itself.
            
            'if node isn't dropped on itself -> set drop target as node's parent
            If nodeDragged.index <> oTree.DropHighlight.index Then
                'Set drop target as selected node's parent
                Set nodeDragged.Parent = oTree.DropHighlight
            End If
            
        '-------------------------------
        '  Node Dragged to Another Node
        '-------------------------------
        Else
        
            'get new parent node info
'            If CountInString(PHOTO_TYPES_MAIN, nodeDragged.key) + CountInString(PHOTO_TYPES_OTHER, nodeDragged.key) = 0 Then
'             If Not ImmovableNode(nodeDragged) Then

            'Save key & text to use when node re-added
            strKey = nodeDragged.key
            strText = nodeDragged.Text
                
            'if the selected node is immovable, set the new parent
            If ImmovableNode(nodeDragged) Then Set oTree.SelectedItem = oTree.DropHighlight

            If Not ImmovableNode(nodeDragged) Then
                'Delete the current node for the photo
                oTree.Nodes.Remove nodeDragged.index
    
                'Add to new location
                Set nodeNew = oTree.Nodes.Add(oTree.DropHighlight, tvwChild, strKey, strText)
                nodeNew.Tag = "M|C|" & strKey & "|" & strText & "|" & oTree.DropHighlight.key

                'update photo type
                TempVars("PhotoType") = oTree.DropHighlight.key
                Me.lblPhotoTypeValue.Caption = nodeNew.Parent

'                If nodeDragged.index <> oTree.DropHighlight.index Then
            'ElseIf nodeDragged.index <> oTree.DropHighlight.index Then'
                    'Set the drop target as the selected node's parent.
'                   Set nodeDragged.Parent = oTree.DropHighlight
'               End If

                'highlight the new node
                oTree.SelectedItem = nodeNew
                oTree.DropHighlight = nodeNew
            End If
        
        End If
    End If

    'determine file(s) dragged
    Dim nodeX As Node, nodeParent As Node
    Dim varFileName As Variant
    'Dim strKey As String
    Dim strDisplayName As String, strSkippedFiles As String
    Dim strDuplicates As String, strPhotoType As String
     
'    If Shift = 1 Then       'only if Shift is held, Drag-N-Drop
    If Data.GetFormat(ccCFFiles) Then
        'defaults
        strSkippedFiles = ""
        strDuplicates = ""
    
        'iterate through dragged files
        For Each varFileName In Data.Files
            'hide error display
            'lblError.visible = False
            
            'Relative, Relationship, Key, Text
            'Unique Key --> absolute path to the file
            'Displayed Text --> file name w/ extension
            strKey = varFileName 'Left$(varFileName, Len(varFileName) - 4)
            strDisplayName = ParseFileName(varFileName)
            
            'include only photos
            If InStr(1, PHOTO_EXT_ALLOWED, LCase(ParseFileExt(varFileName, False)), CompareMethod.TextCompare) Then
                        
                'check for duplicate keys
                If Not IsDuplicateKey(strKey, oTree) Then
                        
                    'check to see if node was static parent or child -> add only to parents
                    If Len(oTree.SelectedItem.key) > 2 Then
                        strPhotoType = oTree.SelectedItem.Parent.key
                        Set nodeParent = oTree.SelectedItem.Parent
                    Else
                        strPhotoType = oTree.SelectedItem.key
                        Set nodeParent = oTree.SelectedItem
                    End If
                        
                    'add node & tag
                    Set nodeX = oTree.Nodes.Add(nodeParent, tvwChild, strKey, strDisplayName)
                    nodeX.Tag = "M|C|" & strKey & "|" & strDisplayName & "|" & strPhotoType 'oTree.SelectedItem.key 'strDisplayName
                    
                    'select the relocated node
                    'oTree.SelectedItem = nodX
                    
                    'get the parent key to identify the form to view
                    'MsgBox nodX.Parent, vbInformation
                    TempVars("PhotoType") = strPhotoType
                    Me.lblPhotoTypeValue.Caption = nodeX.Parent
                    
                    'set full photo path
                    TempVars("FullPhotoPath") = ParseString(nodeX.Tag, 2)
                
                Else
                    'prepare duplicate message
                    strDuplicates = IIf(Len(strDuplicates) > 0, strDuplicates & ",", vbCrLf & "Skipped duplicates:  ") & strDisplayName
                
                End If
            
            Else
                
                strSkippedFiles = IIf(Len(strSkippedFiles) > 0, strSkippedFiles & ", ", "Skipped, non-photo files:  ") & strDisplayName
            
            End If
            
            'prepare error message
            lblError.Caption = strSkippedFiles & strDuplicates
            lblError.BackColor = lngYellow
            lblError.ForeColor = vbRed
            lblError.visible = True
        Next
      Else
        'Data is not in the desired Format
        Effect = ccOLEDropEffectNone
      End If
      
      'update form
      PopulateSubForm
      
 '   Else
 '   End If

    'Deselect the node
    Set nodeDragged = Nothing

    'Unhighlight the nodes.
    Set oTree.DropHighlight = Nothing

Exit_Handler:
    Exit Sub
    
Err_Handler:
    'If you create a circular branch.
    If Err.Number = 35614 Then
        MsgBox "A supervisor cannot report to a subordinate.", _
            vbCritical, "Move Cancelled"
    Else
        MsgBox "An error occurred while trying to move the node.  " & _
            "Please try again." & vbCrLf & Err.Description
    End If
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - tvwTree_OLEDragDrop[frm_Tree])"
    End Select
    Resume Exit_Handler
End Sub

'================================
' Treeview Pseudo-Events
'================================

' ---------------------------------
' SUB:          tvwTree_FindNode
' Description:  find a node based on it's node name, tag, or key
' Assumptions:  -
' Parameters:   tvw - treeview control (treeview object)
'               strFind - item to find (string)
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' daharon, January 19, 2009
' http://stackoverflow.com/questions/459589/select-a-node-in-a-treeview-with-vba
' Adapted:      Bonnie Campbell, July 29, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/29/2015 - initial version
' ---------------------------------
Public Sub tvwTree_FindNode(strFind As String, strType As String, blnExpand As Boolean)
On Error GoTo Err_Handler

    Dim tvwNode As Node
    Dim item As Variant
    
    For Each tvwNode In tvwTree.Object.Nodes 'Me.TreeView.nodes
    
        Select Case strType
            Case "key"
                item = tvwNode.key
            Case "tag"
                item = tvwNode.Tag
            Case "text"
                item = tvwNode.Text
        End Select
        
        If item = strFind Then
           tvwNode.Selected = True
           tvwNode.EnsureVisible
           tvwNode.Expanded = blnExpand
           Exit For
        End If
    
    Next
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - tvwTree_FindNode[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          ExpandCurrentBranch_Click
' Description:  expand the current treeview branch
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
'  shannonds, April 10, 2014
'  http://www.experts-exchange.com/Database/MS_Access/Q_28409093.html
' Adapted:      Bonnie Campbell, July 29, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/29/2015 - initial version
' ---------------------------------
Private Sub ExpandCurrentBranch_Click()
Dim Node As MSComctlLib.Node
Dim idx As Integer

On Error GoTo Err_Handler

    ' loop through all nodes
    For Each Node In Me.tvwTree.Nodes
        If Node.Selected = True Then
            idx = Node.index
            'Expand branch from selected node on
            ExpandBranch Node
            Exit For
        End If
    Next Node
    Me.tvwTree.SetFocus
    Set Me.tvwTree.SelectedItem = Me.tvwTree.Nodes.item(idx)

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - ExpandCurrentBranch_Click[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' SUB:          ExpandBranch_Click
' Description:  expand treeview branch for a given node
' Assumptions:  -
' Parameters:   node - treeview node to expand (node object)
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
'  shannonds, April 10, 2014
'  http://www.experts-exchange.com/Database/MS_Access/Q_28409093.html
' Adapted:      Bonnie Campbell, July 29, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/29/2015 - initial version
' ---------------------------------
Private Sub ExpandBranch(ByVal Node As MSComctlLib.Node)
    Dim i As Integer
    
    For i = Node.index To Node.Next.index - 1
        Me.tvwTree.Nodes.item(i).Expanded = True
'        Debug.Print Me.xTree.Nodes.Item(i).Text
    Next i
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - ExpandBranch_Click[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

'================================
' Subform Methods
'================================

' ---------------------------------
' SUB:          PopulateSubForm
' Description:  populate the subform control based on the phototype
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, July 10, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/10/2015 - initial version
'   BLC - 9/1/2016 - accommmodated "Unclassified" photos
' ---------------------------------
Public Sub PopulateSubForm()
On Error GoTo Err_Handler

    Dim strForm As String

    'default
    lblPhotoTypeValue.ForeColor = lngGray50
    
    Select Case TempVars("phototype")
        Case "R", "T", "F", "V"
            strForm = "PhotoFTORDetails"
        Case "U"
            strForm = "PhotoOtherDetails"
            lblPhotoTypeValue.ForeColor = lngRed
        Case Else
            strForm = "PhotoOtherDetails"
    End Select

    'set subform to display
    Me!fsub.SourceObject = strForm

    'set hints
    SetHints Me.Form, strForm

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (#" & Err.Number & " - Form_Load[Tree form])"
    End Select
    Resume Exit_Handler
End Sub


'--------------- CONSIDER MOVING ---------------

' ---------------------------------
' SUB:          PrepareImageList
' Description:  load an image list
' Assumptions:  -
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, July 23, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/23/2015 - initial version
' ---------------------------------
Private Sub PrepareImageList()
On Error GoTo Err_Handler
    
    Dim ImageName As String
    Dim PhotoFilePath As String
    
    'temporarily add imgList until adding to form
    Dim imgList As ImageList
    
    With imgList.ListImages
    
        .Add , ImageName, LoadPicture(PhotoFilePath)
    
    End With

Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - PrepareImageList[Tree form])"
    End Select
    Resume Exit_Handler
End Sub




' ---------------------------------
' SUB:          CreatePopUpMenu
' Description:  Create a popup context menu for nodes
' Assumptions:  -
' Note:         Requires Microsoft Visual Basic for Applications Extensibility
'               5.3 library (VBE6EXT.OLB) reference
' Parameters:   -
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, July 27, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/27/2015 - initial version
' ---------------------------------
Public Sub CreatePopUpMenu(Optional Node As Node)

On Error GoTo Err_Handler

    ' Purpose: Creates and displays a sample pop-up menu.

    Dim objCommandBar As Office.CommandBar
    
    For Each objCommandBar In Application.CommandBars
    
        If objCommandBar.Name = "My New Popup Menu" Then
        
            objCommandBar.Delete
        
        End If
        
    Next objCommandBar
    
    Dim oCommandBarButton
    Dim objCommandBarComboBox
    
    'create popup menu
    Set objCommandBar = Application.CommandBars.Add _
        ("My New Popup Menu", msoBarPopup)
    With objCommandBar
            
            
        ' ------- Photo Record -------
            Set oCommandBarButton = .Controls.Add(msoControlButton)
            With oCommandBarButton
                .Caption = Node.Text
                '.FaceId = 3
                .Style = msoButtonWrapCaption
                .OnAction = "=MsgBox(""You clicked node.text"")"
            End With
            
            '--------------------------------
            ' Debugging - Display Key & Tag
            '--------------------------------
            If DEV_MODE Then
                Set oCommandBarButton = .Controls.Add(msoControlButton)
                With oCommandBarButton
                    .Caption = "Key:" & Node.key
                    .Style = msoButtonWrapCaption
                End With
                
                Set oCommandBarButton = .Controls.Add(msoControlButton)
                With oCommandBarButton
                    .Caption = "Tag:" & Node.Tag
                    .Style = msoButtonWrapCaption
                End With
            End If

         ' ------- Lock Photo Record -------
            Set oCommandBarButton = .Controls.Add(msoControlButton)
            With oCommandBarButton
                .Caption = "&Lock Photo Record"
                .FaceId = 3
                .Style = msoButtonIconAndCaption
                .OnAction = "=DeletePhotoRecord()"
            End With
            
        ' ------- Save Photo Record -------
            Set oCommandBarButton = .Controls.Add(msoControlButton)
            With oCommandBarButton
                .Caption = "&Save Photo Record"
                .FaceId = 538
                .Style = msoButtonIconAndCaption
            End With
            
            
        ' ------- Move To -----------------

            Set objCommandBarComboBox = .Controls.Add(msoControlDropdown)
            
            Dim PhotoType As Variant

            With objCommandBarComboBox
                For Each PhotoType In Split(PHOTO_TYPES_MAIN, ",")
                    .AddItem PhotoType 'Left(PhotoType, 1)
                Next
                For Each PhotoType In Split(PHOTO_TYPES_OTHER, ",")
                    .AddItem "Other - " & PhotoType '"O" & Left(PhotoType, 1)
                Next

                .Caption = "Move To"
                .Style = msoComboNormal
            
            End With
            
         ' ------- Delete Photo Record -----
            Set oCommandBarButton = .Controls.Add(msoControlButton)
            With oCommandBarButton
                .Caption = "&Delete Photo Record"
                .FaceId = 644
                .Style = msoButtonIconAndCaption
                .OnAction = "=DeletePhotoRecord(node)"
            End With


    End With
    
    objCommandBar.ShowPopup
    'objCommandBar.ShowPopup Form.Width / 2, Form.Height / 2
    'Application.Width / 2, Application.Height / 2
        
    ' To delete this pop-up menu, call:
    ' Application.CommandBars("My New Popup Menu").Delete
    
Exit_Handler:
    Exit Sub
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - CreatePopUpMenu[Tree form])"
    End Select
    Resume Exit_Handler
End Sub

' ---------------------------------
' FUNCTION:     DeletePhotoRecord
' Description:  delete photo record
' Assumptions:  -
' Parameters:   node (treeview node object)
' Returns:      -
' Throws:       none
' References:   none
' Source/date:
' Adapted:      Bonnie Campbell, July 28, 2015 - for NCPN tools
' Revisions:
'   BLC - 7/28/2015 - initial version
' ---------------------------------
Public Function DeletePhotoRecord(Node As Node) As Boolean

On Error GoTo Err_Handler

Debug.Print "DeletePhotoRecord" & Node.Text

Exit_Handler:
    Exit Function
    
Err_Handler:
    Select Case Err.Number
      Case Else
        MsgBox "Error #" & Err.Number & ": " & Err.Description, vbCritical, _
            "Error encountered (" & Err.Number & " - DeletePhotoRecord[Tree form])"
    End Select
    Resume Exit_Handler
End Function

' datAdrenaline, June 4, 2007
' http://www.utteraccess.com/forum/index.php?showtopic=1428240
Private Sub SelectNode()
On Error Resume Next
    
'    Me.xTree.Object.nodes(YourKeyConstant & Me.txtTag).Selected = True
'    If Err <> 0 Then
'        MsgBox "The node key you specified could not be found!"
'        Err.Clear
'    End If
End Sub
